<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin Login & Dashboard</title>

    <style>
        /* Basic layout */
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f4f4f4;
            color: #222;
        }

        .page {
            background: #fff;
            padding: 24px;
            border-radius: 8px;
            max-width: 820px;
            margin: 20px auto;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }

        .hidden { display: none; }

        .toprow {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Small button */
        button.small {
            padding: 8px 10px;
            font-size: 14px;
        }

        /* Dashboard sections */
        .dashboard-section {
            border: 1px solid #e0e0e0;
            padding: 14px;
            margin-bottom: 16px;
            border-radius: 6px;
        }

        /* Profile */
        .profile-row { display: flex; align-items: center; gap: 16px; }
        .profile-photo {
            width: 96px;
            height: 96px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #333;
        }

        /* Inputs */
        input[type="text"],
        input[type="password"],
        input[type="url"],
        input[type="file"],
        input[type="number"],
        textarea {
            width: 100%;
            padding: 10px;
            margin-top: 8px;
            margin-bottom: 12px;
            border-radius: 4px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        /* Buttons */
        button {
            background: #007bff;
            color: white;
            padding: 10px 12px;
            margin-right: 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover { filter: brightness(0.95); }

        button.cancel {
            background: #777;
        }

        /* Messages */
        .error-message { color: #c00; margin-top: 8px; }
        .success-message {
            background: #e6f4ea;
            color: #155724;
            border: 1px solid #c3e6cb;
            padding: 10px;
            border-radius: 6px;
            font-weight: 600;
        }

        /* Projects list */
        .projects-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .project-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            border-radius: 6px;
            border: 1px solid #e3e3e3;
            background: #fafafa;
        }

        .project-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* folder icon */
        .folder-icon {
            font-size: 20px;
            width: 32px;
            height: 32px;
            display:flex;
            align-items:center;
            justify-content:center;
        }

        /* project title style */
        .project-title {
            font-weight: 600;
        }

        /* change button small square */
        .change-btn {
            background: #f0f0f0;
            color: #222;
            padding: 8px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            min-width: 72px;
            text-align: center;
        }

        .change-btn:hover {
            background: #e6e6e6;
        }

        /* form button container */
        .form-buttons {
            display:flex;
            gap:10px;
            margin-top: 6px;
            align-items:center;
        }

        /* responsive */
        @media (max-width: 640px) {
            .page { padding: 16px; margin: 12px; }
            .project-item { flex-direction: column; align-items: flex-start; gap: 8px; }
            .project-left { gap: 8px; }
        }
    </style>
</head>
<body>

    <!-- LOGIN PAGE -->
    <div id="login-page" class="page">
        <h2>Admin Login</h2>
        <form id="login-form">
            <label for="username">Username:</label>
            <input type="text" id="username" required>

            <label for="password">Password:</label>
            <input type="password" id="password" required>

            <button type="submit">Login</button>
            <p id="login-error" class="error-message"></p>
        </form>
    </div>

    <!-- DASHBOARD PAGE -->
    <div id="dashboard-page" class="page hidden">
        <div class="toprow">
            <h1>Welcome, Admin!</h1>
            <button id="logout-button" class="small">Logout</button>
        </div>

        <!-- PROFILE PHOTO -->
        <div class="dashboard-section">
            <h3>Profile Photo</h3>
            <div class="profile-row">
                <img id="profile-pic" src="default-profile.png" class="profile-photo" alt="Profile">
                <div class="profile-controls">
                    <input type="file" id="photo-input" accept="image/*" hidden>
                    <button id="add-change-photo">Add/Change Photo</button>
                </div>
            </div>
        </div>

        <!-- SKILLS MANAGEMENT -->
        <div class="dashboard-section">
            <h3>Skills Management</h3>
            <p id="current-skills">Current Skills: </p>
            <div class="skill-row">
                <input type="text" id="skill-input" placeholder="Enter a skill">
                <button id="add-skill-btn" class="small">Add Skill</button>
                <button id="edit-skill-btn" class="small">Edit Skills</button>
            </div>
        </div>

        <!-- PROJECTS -->
        <div class="dashboard-section">
            <h3>Projects</h3>
            <div id="projects-list" class="projects-list"></div>

            <div class="project-controls">
                <button id="project-button">Add New Project</button>
            </div>
        </div>
    </div>

    <!-- PROJECT PAGE -->
    <div id="project-page" class="page hidden">
        <h2 id="project-form-title">Submit New Project</h2>

        <p id="submit-message" class="success-message hidden">
            âœ” Project saved successfully!
        </p>

        <form id="project-form">
            <label for="project-title">Project Title:</label>
            <input type="text" id="project-title" required>

            <label for="project-description">Description:</label>
            <textarea id="project-description" rows="5" required></textarea>

            <label for="project-technologies">Technologies Used (comma separated):</label>
            <input type="text" id="project-technologies">

            <label for="project-image">Add Image:</label>
            <input type="file" id="project-image" accept="image/*">

            <label for="project-video">Add Video (file):</label>
            <input type="file" id="project-video" accept="video/*">

            <label for="project-position">Position (1 = first, 2 = second, ...):</label>
            <input type="number" id="project-position" min="1">

            <label for="project-github">GitHub Link:</label>
            <input type="url" id="project-github">

            <label for="project-live">Live Demo Link:</label>
            <input type="url" id="project-live">

            <div class="form-buttons">
                <button type="submit" id="submit-project-btn">Submit Project</button>
                <button type="button" id="cancel-project-btn" class="cancel">Cancel</button>
            </div>
        </form>
    </div>

    <script>
        /* Your entire JavaScript exactly as-is, untouched */

        // ----------------- Pages -----------------
        const LOGIN_PAGE = document.getElementById('login-page');
        const DASHBOARD_PAGE = document.getElementById('dashboard-page');
        const PROJECT_PAGE = document.getElementById('project-page');

        function navigateTo(page) {
            [LOGIN_PAGE, DASHBOARD_PAGE, PROJECT_PAGE].forEach(p => p.classList.add('hidden'));
            page.classList.remove('hidden');
        }

        // --------------- Login & Logout ---------------
        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const u = document.getElementById('username').value.trim();
            const p = document.getElementById('password').value.trim();
            if (u === 'admin' && p === 'password') {
                navigateTo(DASHBOARD_PAGE);
                loadAllDataToUI();
            } else {
                document.getElementById('login-error').textContent = 'Invalid username or password';
            }
        });

        document.getElementById('logout-button').addEventListener('click', () => {
            navigateTo(LOGIN_PAGE);
            document.getElementById('login-form').reset();
        });

        // --------------- Profile Photo ----------------
        const photoInput = document.getElementById('photo-input');
        const profilePic = document.getElementById('profile-pic');
        document.getElementById('add-change-photo').addEventListener('click', () => photoInput.click());

        photoInput.addEventListener('change', function() {
            const file = this.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = () => {
                profilePic.src = reader.result;
                localStorage.setItem('profilePhoto', reader.result);
            };
            reader.readAsDataURL(file);
        });

        function loadProfilePhoto() {
            const saved = localStorage.getItem('profilePhoto');
            if (saved) profilePic.src = saved;
        }

        // --------------- Skills ----------------
        let skills = JSON.parse(localStorage.getItem('skills')) || ['HTML', 'CSS', 'JavaScript'];

        function loadSkillsUI() {
            document.getElementById('current-skills').textContent = 'Current Skills: ' + skills.join(', ');
        }

        document.getElementById('add-skill-btn').addEventListener('click', () => {
            const val = document.getElementById('skill-input').value.trim();
            if (!val) return alert('Enter a skill');
            skills.push(val);
            localStorage.setItem('skills', JSON.stringify(skills));
            loadSkillsUI();
            document.getElementById('skill-input').value = '';
        });

        document.getElementById('edit-skill-btn').addEventListener('click', () => {
            const newList = prompt('Enter skills separated by commas:', skills.join(', '));
            if (newList !== null) {
                skills = newList.split(',').map(s => s.trim()).filter(Boolean);
                localStorage.setItem('skills', JSON.stringify(skills));
                loadSkillsUI();
            }
        });

        // --------------- Projects Storage & UI ----------------
        let projects = JSON.parse(localStorage.getItem('projects')) || [];
        let editingProjectId = null;

        let stagedImageData = null;
        let stagedVideoData = null;

        const projectsListEl = document.getElementById('projects-list');
        const projectButton = document.getElementById('project-button');

        const projectForm = document.getElementById('project-form');
        const submitProjectBtn = document.getElementById('submit-project-btn');
        const cancelProjectBtn = document.getElementById('cancel-project-btn');
        const backToDashboardBtn = document.getElementById('back-to-dashboard-btn');
        const projectFormTitle = document.getElementById('project-form-title');

        const inputTitle = document.getElementById('project-title');
        const inputDescription = document.getElementById('project-description');
        const inputTechnologies = document.getElementById('project-technologies');
        const inputImage = document.getElementById('project-image');
        const inputVideo = document.getElementById('project-video');
        const inputPosition = document.getElementById('project-position');
        const inputGithub = document.getElementById('project-github');
        const inputLive = document.getElementById('project-live');

        projectButton.addEventListener('click', () => openProjectFormForNew());

        cancelProjectBtn.addEventListener('click', () => {
            if (confirm('Discard changes and go back to dashboard?')) {
                resetProjectForm();
                navigateTo(DASHBOARD_PAGE);
            }
        });

        inputImage.addEventListener('change', function() {
            const f = this.files[0];
            if (!f) {
                stagedImageData = null;
                return;
            }
            const reader = new FileReader();
            reader.onload = () => stagedImageData = reader.result;
            reader.readAsDataURL(f);
        });

        inputVideo.addEventListener('change', function() {
            const f = this.files[0];
            if (!f) {
                stagedVideoData = null;
                return;
            }
            const reader = new FileReader();
            reader.onload = () => stagedVideoData = reader.result;
            reader.readAsDataURL(f);
        });

        projectForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const title = inputTitle.value.trim();
            const description = inputDescription.value.trim();
            const technologies = inputTechnologies.value.split(',').map(s => s.trim()).filter(Boolean);
            const github = inputGithub.value.trim();
            const live = inputLive.value.trim();

            let posVal = inputPosition.value.trim();
            let position = null;
            if (posVal !== '') {
                const parsed = parseInt(posVal, 10);
                if (!isNaN(parsed) && parsed >= 1) position = parsed;
                else {
                    alert('Position must be a number 1 or greater.');
                    return;
                }
            }

            if (!title) {
                alert('Project title required');
                return;
            }

            let imageData = stagedImageData;
            let videoData = stagedVideoData;

            if (editingProjectId) {
                const idx = projects.findIndex(p => p.id === editingProjectId);
                if (idx === -1) {
                    alert('Project not found');
                    return;
                }
                if (!imageData) imageData = projects[idx].imageData || null;
                if (!videoData) videoData = projects[idx].videoData || null;

                projects[idx] = {
                    ...projects[idx],
                    title, description, technologies, imageData, videoData, position, github, live,
                    updatedAt: Date.now()
                };
                showTemporaryMessage('Project updated successfully');
            } else {
                const newProject = {
                    id: 'proj_' + Date.now(),
                    title, description, technologies,
                    imageData: imageData || null,
                    videoData: videoData || null,
                    position,
                    github, live,
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                };
                projects.push(newProject);
                showTemporaryMessage('Project added successfully');
            }

            localStorage.setItem('projects', JSON.stringify(projects));

            stagedImageData = null;
            stagedVideoData = null;

            resetProjectForm();

            loadAllDataToUI();
            navigateTo(DASHBOARD_PAGE);
        });

        function renderProjectsList() {
            projectsListEl.innerHTML = '';

            const visibleProjects = projects
                .filter(p => p.position !== null && Number.isInteger(p.position) && p.position >= 1)
                .sort((a, b) => {
                    if (a.position !== b.position) return a.position - b.position;
                    return b.updatedAt - a.updatedAt;
                });

            if (!visibleProjects.length) {
                projectsListEl.innerHTML = '<div style="color:#666">No positioned projects yet.</div>';
                return;
            }

            visibleProjects.forEach(project => {
                const item = document.createElement('div');
                item.className = 'project-item';

                const left = document.createElement('div');
                left.className = 'project-left';

                const icon = document.createElement('div');
                icon.className = 'folder-icon';
                icon.textContent = 'ðŸ“';

                const title = document.createElement('div');
                title.className = 'project-title';
                title.textContent = project.title;

                left.appendChild(icon);
                left.appendChild(title);

                const right = document.createElement('div');

                const changeBtn = document.createElement('button');
                changeBtn.className = 'change-btn';
                changeBtn.textContent = 'CHANGE';
                changeBtn.addEventListener('click', () => openProjectFormForEdit(project.id));

                right.appendChild(changeBtn);

                item.appendChild(left);
                item.appendChild(right);

                projectsListEl.appendChild(item);
            });
        }

        function openProjectFormForNew() {
            editingProjectId = null;
            projectFormTitle.textContent = 'Submit New Project';
            submitProjectBtn.textContent = 'Submit Project';
            resetProjectForm();
            navigateTo(PROJECT_PAGE);
        }

        function openProjectFormForEdit(projectId) {
            const proj = projects.find(p => p.id === projectId);
            if (!proj) return alert('Project not found');

            editingProjectId = projectId;
            projectFormTitle.textContent = 'Edit Project';
            submitProjectBtn.textContent = 'Save Changes';

            inputTitle.value = proj.title || '';
            inputDescription.value = proj.description || '';
            inputTechnologies.value = (proj.technologies || []).join(', ');
            inputGithub.value = proj.github || '';
            inputLive.value = proj.live || '';
            inputPosition.value = (proj.position && Number.isInteger(proj.position)) ? proj.position : '';

            stagedImageData = null;
            stagedVideoData = null;

            navigateTo(PROJECT_PAGE);
        }

        function resetProjectForm() {
            projectForm.reset();
            stagedImageData = null;
            stagedVideoData = null;
            editingProjectId = null;
            submitProjectBtn.textContent = 'Submit Project';
            projectFormTitle.textContent = 'Submit New Project';
        }

        function showTemporaryMessage(msg) {
            const msgEl = document.getElementById('submit-message');
            msgEl.textContent = 'âœ” ' + msg;
            msgEl.classList.remove('hidden');
            setTimeout(() => msgEl.classList.add('hidden'), 2200);
        }

        function loadAllDataToUI() {
            loadProfilePhoto();
            loadSkillsUI();
            projects = JSON.parse(localStorage.getItem('projects')) || projects;
            renderProjectsList();
        }

        window.addEventListener('load', () => {
            skills = JSON.parse(localStorage.getItem('skills')) || skills;
            projects = JSON.parse(localStorage.getItem('projects')) || projects;
            loadProfilePhoto();
            loadSkillsUI();
            renderProjectsList();
        });
    </script>

</body>
</html>
